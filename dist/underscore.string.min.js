//  underscore.string
//  (c) 2013 Esa-Matti Suuronen <esa-matti aet suuronen dot org>
//  Underscore.string is freely distributable under the terms of the MIT license.
//  Documentation http://epeli.github.com/underscore.string/
//  Some code is borrowed from MooTools and Alexandru Marasteanu.
//  Version 2.3.0
!function(r,e){"use strict";var n=e.prototype.trim,t=e.prototype.trimRight,u=e.prototype.trimLeft,i=[].slice,l=function(r){return null==r?"\\s":r.source?r.source:"["+p.escapeRegExp(r)+"]"},a=function(r,e){if(1>e)return"";for(var n="";e>0;)1&e&&(n+=r),e>>=1,r+=r;return n},o={lt:"<",gt:">",quot:'"',apos:"'",amp:"&"},c={};for(var s in o)c[o[s]]=s;var f=function(){function r(r){return Object.prototype.toString.call(r).slice(8,-1).toLowerCase()}var n=a,t=function(){return t.cache.hasOwnProperty(arguments[0])||(t.cache[arguments[0]]=t.parse(arguments[0])),t.format.call(null,t.cache[arguments[0]],arguments)};return t.format=function(t,u){var i,l,a,o,c,s,p,h=1,g=t.length,d="",m=[];for(l=0;g>l;l++)if(d=r(t[l]),"string"===d)m.push(t[l]);else if("array"===d){if(o=t[l],o[2])for(i=u[h],a=0;o[2].length>a;a++){if(!i.hasOwnProperty(o[2][a]))throw Error(f('[_.sprintf] property "%s" does not exist',o[2][a]));i=i[o[2][a]]}else i=o[1]?u[o[1]]:u[h++];if(/[^s]/.test(o[8])&&"number"!=r(i))throw Error(f("[_.sprintf] expecting number but found %s",r(i)));switch(o[8]){case"b":i=i.toString(2);break;case"c":i=e.fromCharCode(i);break;case"d":i=parseInt(i,10);break;case"e":i=o[7]?i.toExponential(o[7]):i.toExponential();break;case"f":i=o[7]?parseFloat(i).toFixed(o[7]):parseFloat(i);break;case"o":i=i.toString(8);break;case"s":i=(i=e(i))&&o[7]?i.substring(0,o[7]):i;break;case"u":i=Math.abs(i);break;case"x":i=i.toString(16);break;case"X":i=i.toString(16).toUpperCase()}i=/[def]/.test(o[8])&&o[3]&&i>=0?"+"+i:i,s=o[4]?"0"==o[4]?"0":o[4].charAt(1):" ",p=o[6]-e(i).length,c=o[6]?n(s,p):"",m.push(o[5]?i+c:c+i)}return m.join("")},t.cache={},t.parse=function(r){for(var e=r,n=[],t=[],u=0;e;){if(null!==(n=/^[^\x25]+/.exec(e)))t.push(n[0]);else if(null!==(n=/^\x25{2}/.exec(e)))t.push("%");else{if(null===(n=/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/.exec(e)))throw Error("[_.sprintf] huh?");if(n[2]){u|=1;var i=[],l=n[2],a=[];if(null===(a=/^([a-z_][a-z_\d]*)/i.exec(l)))throw Error("[_.sprintf] huh?");for(i.push(a[1]);""!==(l=l.substring(a[0].length));)if(null!==(a=/^\.([a-z_][a-z_\d]*)/i.exec(l)))i.push(a[1]);else{if(null===(a=/^\[(\d+)\]/.exec(l)))throw Error("[_.sprintf] huh?");i.push(a[1])}n[2]=i}else u|=2;if(3===u)throw Error("[_.sprintf] mixing positional and named placeholders is not (yet) supported");t.push(n)}e=e.substring(n[0].length)}return t},t}(),p={VERSION:"3.0.0"};p.isBlank=function(r){return null==r&&(r=""),/^\s*$/.test(r)},p.stripTags=function(r){return null==r?"":e(r).replace(/<\/?[^>]+>/g,"")},p.capitalize=function(r){return r=null==r?"":e(r),r.charAt(0).toUpperCase()+r.slice(1)},p.chop=function(r,n){return null==r?[]:(r=e(r),n=~~n,n>0?r.match(RegExp(".{1,"+n+"}","g")):[r])},p.clean=function(r){return p.strip(r).replace(/\s+/g," ")},p.count=function(r,n){if(null==r||null==n)return 0;r=e(r),n=e(n);for(var t=0,u=0,i=n.length;;){if(u=r.indexOf(n,u),-1===u)break;t++,u+=i}return t},p.chars=function(r){return null==r?[]:e(r).split("")},p.swapCase=function(r){return null==r?"":e(r).replace(/\S/g,function(r){return r===r.toUpperCase()?r.toLowerCase():r.toUpperCase()})},p.escapeHTML=function(r){return null==r?"":e(r).replace(/[&<>"']/g,function(r){return"&"+("'"===r?"#39":c[r])+";"})},p.unescapeHTML=function(r){return null==r?"":e(r).replace(/\&([^;]+);/g,function(r,n){var t;return n in o?o[n]:(t=n.match(/^#x([\da-fA-F]+)$/))?e.fromCharCode(parseInt(t[1],16)):(t=n.match(/^#(\d+)$/))?e.fromCharCode(~~t[1]):r})},p.escapeRegExp=function(r){return null==r?"":e(r).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")},p.splice=function(r,e,n,t){var u=p.chars(r);return u.splice(~~e,~~n,t),u.join("")},p.insert=function(r,e,n){return p.splice(r,e,0,n)},p.include=function(r,n){return""===n?!0:null==r?!1:-1!==e(r).indexOf(n)},p.join=function(r){return null==r&&(r=""),i.call(arguments,1).join(r)},p.lines=function(r){return null==r?[]:e(r).split("\n")},p.reverse=function(r){return p.chars(r).reverse().join("")},p.startsWith=function(r,n){return""===n?!0:null==r||null==n?!1:(r=e(r),n=e(n),r.length>=n.length&&r.slice(0,n.length)===n)},p.endsWith=function(r,n){return""===n?!0:null==r||null==n?!1:(r=e(r),n=e(n),r.length>=n.length&&r.slice(r.length-n.length)===n)},p.succ=function(r){return null==r?"":e(r).replace(/.$/,function(r){return e.fromCharCode(r.charCodeAt(0)+1)})},p.titleize=function(r){return null==r?"":e(r).replace(/(?:^|\s)\S/g,function(r){return r.toUpperCase()})},p.camelize=function(r){return p.trim(r).replace(/[-_\s]+(.)?/g,function(r,e){return e.toUpperCase()})},p.underscored=function(r){return p.trim(r).replace(/([a-z\d])([A-Z]+)/g,"$1_$2").replace(/[-\s]+/g,"_").toLowerCase()},p.dasherize=function(r){return p.trim(r).replace(/([A-Z])/g,"-$1").replace(/[-_\s]+/g,"-").toLowerCase()},p.classify=function(r){return null==r?"":p.titleize(e(r).replace(/[\W_]/g," ")).replace(/\s/g,"")},p.humanize=function(r){return p.capitalize(p.underscored(r).replace(/_id$/,"").replace(/_/g," "))},p.trim=function(r,t){return null==r?"":!t&&n?n.call(r):(t=l(t),e(r).replace(RegExp("^"+t+"+|"+t+"+$","g"),""))},p.ltrim=function(r,n){return null==r?"":!n&&u?u.call(r):e(r).replace(RegExp("^"+l(n)+"+"),"")},p.rtrim=function(r,n){return null==r?"":!n&&t?t.call(r):e(r).replace(RegExp(l(n)+"+$"),"")},p.truncate=function(r,n,t){return null==r?"":(r=e(r),t=t||"...",n=~~n,r.length>n?r.slice(0,n)+t:r)},p.prune=function(r,n,t){if(null==r)return"";if(r=e(r),n=~~n,t=null!=t?e(t):"...",n>=r.length)return r;var u=function(r){return r.toUpperCase()!==r.toLowerCase()?"A":" "},i=r.slice(0,n+1).replace(/.(?=\W*\w*$)/g,u);return i=i.slice(i.length-2).match(/\w\w/)?i.replace(/\s*\S+$/,""):p.rtrim(i.slice(0,i.length-1)),(i+t).length>r.length?r:r.slice(0,i.length)+t},p.words=function(r,e){return p.isBlank(r)?[]:p.trim(r,e).split(e||/\s+/)},p.pad=function(r,n,t,u){r=null==r?"":e(r),n=~~n;var i=0;switch(t=null==t?" ":e(t),t.length>1&&(t=t.charAt(0)),u){case"right":return i=n-r.length,r+a(t,i);case"both":return i=n-r.length,a(t,Math.ceil(i/2))+r+a(t,Math.floor(i/2));default:return i=n-r.length,a(t,i)+r}},p.lpad=function(r,e,n){return p.pad(r,e,n)},p.rpad=function(r,e,n){return p.pad(r,e,n,"right")},p.lrpad=function(r,e,n){return p.pad(r,e,n,"both")},p.sprintf=f,p.vsprintf=function(r,e){return f.apply(null,[r].concat(e))},p.toNumber=function(r,n){return r?(r=e(r),Number(Number(r).toFixed(~~n))):0},p.numberFormat=function(r,e,n,t){if(null==r)return"";if(r=Number(r),isNaN(r))return"";null==t&&(t=","),null==n&&(n="."),r=r.toFixed(~~e);var u=r.split("."),i=u[0],l=u[1]?n+u[1]:"";return i.replace(/(\d)(?=(?:\d{3})+$)/g,"$1"+t)+l},p.strRight=function(r,n){if(null==r)return"";r=e(r),n=null!=n?e(n):n;var t=n?r.indexOf(n):-1;return~t?r.slice(t+n.length,r.length):r},p.strRightBack=function(r,n){if(null==r)return"";r=e(r),n=null!=n?e(n):n;var t=n?r.lastIndexOf(n):-1;return~t?r.slice(t+n.length,r.length):r},p.strLeft=function(r,n){if(null==r)return"";r=e(r),n=null!=n?e(n):n;var t=n?r.indexOf(n):-1;return~t?r.slice(0,t):r},p.strLeftBack=function(r,e){if(null==r)return"";r+="",e=null!=e?""+e:e;var n=r.lastIndexOf(e);return~n?r.slice(0,n):r},p.toSentence=function(r,e,n,t){e=e||", ",n=n||" and ";var u=r.slice(),i=u.pop();return r.length>2&&t&&(n=p.rtrim(e)+n),u.length?u.join(e)+n+i:i},p.toSentenceSerial=function(){var r=i.call(arguments);return r[3]=!0,p.toSentence.apply(p,r)},p.slugify=function(r){if(null==r)return"";var n="ąàáäâãåæćęèéëêìíïîłńòóöôõøùúüûñçżź",t="aaaaaaaaceeeeeiiiilnoooooouuuunczz",u=RegExp(l(n),"g");return r=e(r).toLowerCase().replace(u,function(r){var e=n.indexOf(r);return t.charAt(e)||"-"}),p.dasherize(r.replace(/[^\w\s-]/g,""))},p.surround=function(r,e){return[e,r,e].join("")},p.quote=function(r){return p.surround(r,'"')},p.repeat=function(r,n,t){if(null==r)return"";if(n=~~n,null==t)return a(e(r),n);for(var u=[];n>0;u[--n]=r);return u.join(t)},p.levenshtein=function(r,n){if(null==r&&null==n)return 0;if(null==r)return e(n).length;if(null==n)return e(r).length;r=e(r),n=e(n);for(var t,u,i=[],l=0;n.length>=l;l++)for(var a=0;r.length>=a;a++)u=l&&a?r.charAt(a-1)===n.charAt(l-1)?t:Math.min(i[a],i[a-1],t)+1:l+a,t=i[a],i[a]=u;return i.pop()},p.strip=p.trim,p.lstrip=p.ltrim,p.rstrip=p.rtrim,p.center=p.lrpad,p.rjust=p.lpad,p.ljust=p.rpad,p.includes=p.include,p.contains=p.include,p.q=p.quote;var h=function(r){if(!r)return{str:p};var e=function(e){return null==e||r.isString(e)||r.isNumber(e)},n=r.omit(p,"include","contains","reverse","splice");return r.mixin(n),r.mixin(r.reduce(["include","contains"],function(n,t){var u=p[t],i=r[t];return n[t]=function(r){var n=e(r)?u:i;return n.apply(this,arguments)},n},{})),r.each(["reverse","splice"],function(n){var t=p[n],u=r.prototype[n],i={};i[n]=t,r.mixin(i);var l=r.prototype[n];r.prototype[n]=function(){var r=e(this._wrapped)?l:u;return r.apply(this,arguments)}}),r.str=r.string=p,r};r._=h(r._),p.integrate=h,"undefined"!=typeof exports&&("undefined"!=typeof module&&module.exports&&(module.exports=p),exports._s=p),"function"==typeof define&&define.amd&&define("underscore.string",[],function(){return p})}(this,String);